swagger: "2.0"
info:
  description: ""
  version: "1.0.0"
  title: "MOGT Smev3 API"
  termsOfService: "https://www.mogt.ru/"
  contact:
    email: "mogt_info@mosreg.ru"
  license:
    name: "Apache 2.0"
    url: "http://www.apache.org/licenses/LICENSE-2.0.html"
host: "localhost"
basePath: "/v1"
tags:
- name: "json2xml"
  description: "Json to xml conversion according to smev 3 xsd schemes"
- name: "smev signer"
  description: "Converting messages to smev-3.X format"
- name: "record repository"
  description: "manipulating and storing smev message series"
- name: "file repository"
  description: "manipulating and storing smev files"
- name: "smev connector"
  description: "connect and communicate with smev 3 endpoints"
schemes:
- "https"
- "http"
paths:
  /json2xml/{query_type}:
    post:
      tags:
      - "json2xml"
      summary: "Convert json to xml"
      description: ""
      operationId: "json2xml"
      consumes:
      - "application/json"
      produces:
      - "application/json"
      parameters:
      - name: "query_type"
        in: "path"
        description: "Name smev type"
        required: true
        type: "string"
        format: "str"
      - in: "body"
        name: "body"
        description: "Smev message template"
        required: true
      responses:
        "200":
          description: "successful operation"
          schema:
            $ref: "#/definitions/Json2XmlResponse"
  /signer/message/{cert_type}:
    post:
      tags:
      - "smev signer"
      summary: "Convert message to smev-3.X format"
      description: ""
      operationId: "signer"
      consumes:
      - "application/json"
      produces:
      - "application/json"
      parameters:
      - name: "cert_type"
        in: "path"
        description: "Sertificate alias"
        required: true
        type: "string"
        format: "str"
      - in: "body"
        name: "body"
        description: "Smev message xml template"
        required: true
        schema:
          $ref: "#/definitions/SmevSignerRequest"
      responses:
        "200":
          description: "successful operation"
          schema:
            $ref: "#/definitions/SmevMesageXmlResponse"
  /signer/pkcs7/{cert_type}:
    post:
      tags:
      - "smev signer"
      summary: "make pkcs7 signature for a file"
      description: ""
      operationId: "signer"
      consumes:
      - "application/text"
      produces:
      - "application/text"
      parameters:
      - name: "cert_type"
        in: "path"
        description: "Sertificate alias"
        required: true
        type: "string"
        format: "str"
      - in: "body"
        name: "body"
        description: "base64 string of file"
        required: true
        type: "string"
        format: "base64"
      responses:
        "200":
          description: "successful operation"
          schema:
            description: "base64 string of pkcs7 signature"
            type: "string"
            format: "base64"
  /records:
    get:
      tags:
      - "record repository"
      summary: "Get all records"
      description: ""
      operationId: "get record"
      produces:
      - "application/json"
      parameters:
      - name: "page"
        in: "query"
        description: "page"
        required: false
        type: "int"
      responses:
        "200":
          description: "successful operation"
          schema:
            type: "array"
            items:
              $ref: "#/definitions/Record"
  /record/{id}/new:
    get:
      tags:
      - "record repository"
      summary: "Create record with id"
      description: ""
      operationId: "create record"
      produces:
      - "application/json"
      parameters:
      - name: "id"
        in: "path"
        description: "record id"
        required: true
        type: "string"
        format: "uuid"
      responses:
        "200":
          description: "successful operation"
          schema:
            $ref: "#/definitions/Record"
  /record/{id}:
    get:
      tags:
      - "record repository"
      summary: "Get record by id"
      description: ""
      operationId: "get record"
      produces:
      - "application/json"
      parameters:
      - name: "id"
        in: "path"
        description: "record id"
        required: true
        type: "string"
        format: "uuid"
      responses:
        "200":
          description: "successful operation"
          schema:
            $ref: "#/definitions/Record"
    delete:
      tags:
      - "record repository"
      summary: "Delete record by id"
      description: ""
      operationId: "delete record"
      produces:
      - "application/json"
      parameters:
      - name: "id"
        in: "path"
        description: "record id"
        required: true
        type: "string"
        format: "uuid"
      responses:
        "200":
          description: "successful operation"
          schema:
            type: "object"
            properties:
              remove_records:
                type: "int"
  /record/{id}/{message_type}:
    get:
      tags:
      - "record repository"
      summary: "Get message from record"
      description: ""
      operationId: "get record message"
      produces:
      - "application/json"
      parameters:
      - name: "id"
        in: "path"
        description: "record id"
        required: true
        type: "string"
        format: "uuid"
      - name: "message_type"
        in: "path"
        description: "record id"
        required: true
        type: "string"
        enum:
        - "SendRequestRequest"
        - "SendResponseRequest"
        - "GetRequestRequest"
        - "GetResponseRequest"
        - "AckRequest"
      responses:
        "200":
          description: "successful operation"
          schema:
            $ref: "#/definitions/RecordMessage"
    put:
      tags:
      - "record repository"
      summary: "Update record message"
      description: ""
      operationId: "put record message"
      consumes:
      - "application/json"
      produces:
      - "application/json"
      parameters:
      - name: "id"
        in: "path"
        description: "record id"
        required: true
        type: "string"
        format: "uuid"
      - name: "message_type"
        in: "path"
        description: "record id"
        required: true
        type: "string"
        enum:
        - "SendRequestRequest"
        - "SendResponseRequest"
        - "GetRequestRequest"
        - "GetResponseRequest"
        - "AckRequest"
      - name: "body"
        in: "body"
        description: "record for update"
        required: true
        schema:
          $ref: "#/definitions/RecordMessageUpdate"
      responses:
        "200":
          description: "successful operation"
          schema:
            type: "xml"
  /record/{id}/{message_type}/xml:
    get:
      tags:
      - "record repository"
      summary: "Get message from record as xml"
      description: ""
      operationId: "get record message"
      produces:
      - "application/xml"
      parameters:
      - name: "id"
        in: "path"
        description: "record id"
        required: true
        type: "string"
        format: "uuid"
      - name: "message_type"
        in: "path"
        description: "record id"
        required: true
        type: "string"
        enum:
        - "SendRequestRequest"
        - "SendResponseRequest"
        - "GetRequestRequest"
        - "GetResponseRequest"
        - "AckRequest"
      responses:
        "200":
          description: "successful operation"
          schema:
            type: "string"
            format: "xml"
  /record/{id}/{message_type}/id:
    get:
      tags:
      - "record repository"
      summary: "Get messageId element"
      description: ""
      operationId: "get record message"
      produces:
      - "application/json"
      parameters:
      - name: "id"
        in: "path"
        description: "record id"
        required: true
        type: "string"
        format: "uuid"
      - name: "message_type"
        in: "path"
        description: "record id"
        required: true
        type: "string"
        enum:
        - "SendRequestRequest"
        - "SendResponseRequest"
        - "GetRequestRequest"
        - "GetResponseRequest"
        - "AckRequest"
      responses:
        "200":
          description: "successful operation"
          schema:
            type: "object"
            properties:
              id:
                type: "string"
                format: "uuid"
  /record/{id}/{message_type}/tfp_attachment:
    get:
      tags:
      - "record repository"
      summary: "Get smev ftp attachment info"
      description: ""
      operationId: "get_tfp_attachment"
      produces:
      - "application/json"
      parameters:
      - name: "id"
        in: "path"
        description: "record id"
        required: true
        type: "string"
        format: "uuid"
      - name: "message_type"
        in: "path"
        description: "record id"
        required: true
        type: "string"
        enum:
        - "GetRequestResponse"
        - "GetResponseResponse"
      responses:
        "200":
          description: "successful operation"
          schema:
            type: "object"
            properties:
              user:
                type: "string"
                format: "smev ftp user"
              password:
                type: "string"
                format: "smev ftp password"
              path:
                type: "string"
                format: "smev ftp file path"
            
definitions:
  Json2XmlResponse:
    type: "object"
    properties:
      xml:
        type: "string"
        format: "xml"
  SmevSignerRequest:
    type: "object"
    properties:
      id:
        type: "string"
        format: "uuid or 0"
      xml:
        type: "string"
        format: "xml"
      to:
        type: "string"
        format: "uuid"
        required: false
      msgType:
        type: "string"
        enum:
        - "SendRequestRequest"
        - "SendResponseRequest"
        - "GetRequestRequest"
        - "GetResponseRequest"
        - "AckRequest"
      tagForSign:
        type: "string"
        enum:
        - "SIGNED_BY_CONSUMER"
        - "SIGNED_BY_CALLER"
      attachments:
        type: "array"
        items:
          type: "string"
          format: "file id"

  SmevMesageXmlResponse:
    type: "object"
    properties:
      id:
        type: "string"
        format: "uuid"
      xml:
        type: "string"
        format: "xml"

  Record:
    type: "object"
    properties:
      id:
        type: "string"
        format: "uuid"
      date:
        type: "string"
        format: "datetime (UTC)"
      mesages:
        type: "array"
        items:
          type: "string"
          enum:
          - "SendRequestRequest"
          - "SendResponseRequest"
          - "GetRequestRequest"
          - "GetResponseRequest"
          - "AckRequest"
  RecordMessage:
    type: "object"
    properties:
      id:
        type: "string"
        format: "uuid"
      xml:
        type: "string"
        format: "xml"
  RecordMessageUpdate:
    type: "object"
    properties:
      xml:
        type: "string"
        format: "xml"
  RecordMessageUpdateResponse:
    type: "object"
    properties:
      updated_records:
        type: "int"

externalDocs:
  description: "Find out more about"
  url: "http://mogt"